///////////////////////////////////////////////////////////////////////////
///   Namespace:      Mgm.VI.Business.UnitTests
///   Author:         Nour Douchi                    Date: 11/03/2019
///   Notes:          
///   Revision History:
///   Name:           Date:        Description:
///////////////////////////////////////////////////////////////////////////

using System;
using Xunit;
using Mgm.VI.Common;
using System.Xml.Schema;
using System.Xml;
using System.IO;
using System.Xml.Linq;
using Mgm.VI.Repository;
using Mgm.VI.Data.Dto;

namespace Mgm.VI.Business.UnitTests
{
    public class UnitTest_ServiceRequestStatusUpdate
    {
        static class ValidData
        {
            #region 
            public static string XsdDoc = @"<?xml version='1.0' encoding='UTF-8'?><xs:schema xmlns:xs='http://www.w3.org/2001/XMLSchema' elementFormDefault='qualified' attributeFormDefault='unqualified'><xs:element name='ServiceRequest'><xs:complexType><xs:sequence><xs:element name='Contracts'><xs:complexType><xs:sequence><xs:element name='Contract'><xs:complexType><xs:sequence><xs:element name='Titles'><xs:complexType><xs:sequence><xs:element name='Title'><xs:complexType><xs:sequence><xs:element name='LineItems'><xs:complexType><xs:sequence><xs:element name='LineItem'><xs:complexType><xs:sequence><xs:element name='Orders'><xs:complexType><xs:sequence><xs:element name='Order' maxOccurs='unbounded'><xs:complexType><xs:sequence><xs:element name='SRDueDate' type='xs:string'></xs:element><xs:element name='EmbargoDate'></xs:element><xs:element name='PrimaryVideo' type='xs:string'></xs:element><xs:element name='SecondaryAudio' type='xs:string'></xs:element><xs:element name='SubtitlesFull' type='xs:string'></xs:element><xs:element name='SubtitlesForced' type='xs:string'></xs:element><xs:element name='ClosedCaptions'></xs:element><xs:element name='Trailer'></xs:element><xs:element name='RebillType' type='xs:string'></xs:element><xs:element name='Amount'></xs:element><xs:element name='MetaData'></xs:element><xs:element name='ArtWork'></xs:element><xs:element name='Document'></xs:element><xs:element name='EOPPO'></xs:element><xs:element name='EOPDueDate'></xs:element><xs:element name='EOPStatus' type='xs:string'></xs:element><xs:element name='EOPResource'></xs:element><xs:element name='EOPNotes'></xs:element><xs:element name='PPSPO' type='xs:int'></xs:element><xs:element name='PPSDueDate' type='xs:string'></xs:element><xs:element name='PPSStatus' type='xs:string'></xs:element><xs:element name='PPSResource'></xs:element><xs:element name='PPSNotes'></xs:element><xs:element name='MaterialNotes' type='xs:string'></xs:element><xs:element name='Other'></xs:element><xs:element name='IPMMedia'></xs:element><xs:element name='Rejections'><xs:complexType><xs:sequence><xs:element name='Rejection'><xs:complexType><xs:attribute name='ID' type='xs:string'></xs:attribute><xs:attribute name='CurrentStatus' type='xs:string'></xs:attribute><xs:attribute name='Asset' type='xs:string'></xs:attribute><xs:attribute name='RejectionCode' type='xs:string'></xs:attribute><xs:attribute name='Issue' type='xs:string'></xs:attribute><xs:attribute name='CommentsHistory' type='xs:string'></xs:attribute><xs:attribute name='RejectedBy' type='xs:string'></xs:attribute><xs:attribute name='RejectionDate' type='xs:string'></xs:attribute><xs:attribute name='Urgency' type='xs:string'></xs:attribute><xs:attribute name='RootCause' type='xs:string'></xs:attribute><xs:attribute name='Document' type='xs:string'></xs:attribute></xs:complexType></xs:element><xs:element name='Redelivered'><xs:complexType><xs:attribute name='ID' type='xs:string'></xs:attribute><xs:attribute name='CurrentStatus' type='xs:string'></xs:attribute><xs:attribute name='Asset' type='xs:string'></xs:attribute><xs:attribute name='RejectionCode' type='xs:string'></xs:attribute><xs:attribute name='Issue' type='xs:string'></xs:attribute><xs:attribute name='CommentsHistory' type='xs:string'></xs:attribute><xs:attribute name='RejectedBy' type='xs:string'></xs:attribute><xs:attribute name='RejectionDate' type='xs:string'></xs:attribute><xs:attribute name='Urgency' type='xs:string'></xs:attribute><xs:attribute name='RootCause' type='xs:string'></xs:attribute><xs:attribute name='Document' type='xs:string'></xs:attribute></xs:complexType></xs:element><xs:element name='Resolved'><xs:complexType><xs:attribute name='ID' type='xs:string'></xs:attribute><xs:attribute name='CurrentStatus' type='xs:string'></xs:attribute><xs:attribute name='Asset' type='xs:string'></xs:attribute><xs:attribute name='RejectionCode' type='xs:string'></xs:attribute><xs:attribute name='Issue' type='xs:string'></xs:attribute><xs:attribute name='CommentsHistory' type='xs:string'></xs:attribute><xs:attribute name='RejectedBy' type='xs:string'></xs:attribute><xs:attribute name='RejectionDate' type='xs:string'></xs:attribute><xs:attribute name='Urgency' type='xs:string'></xs:attribute><xs:attribute name='RootCause' type='xs:string'></xs:attribute><xs:attribute name='Document' type='xs:string'></xs:attribute></xs:complexType></xs:element></xs:sequence></xs:complexType></xs:element></xs:sequence><xs:attribute name='ID' type='xs:int'></xs:attribute><xs:attribute name='ServicingStatus' type='xs:string'></xs:attribute><xs:attribute name='Version' type='xs:string'></xs:attribute></xs:complexType></xs:element></xs:sequence></xs:complexType></xs:element></xs:sequence><xs:attribute name='ID' type='xs:int'></xs:attribute><xs:attribute name='ServicingStatus' type='xs:string'></xs:attribute><xs:attribute name='IPMMedia' type='xs:string'></xs:attribute><xs:attribute name='IPMTerritory' type='xs:string'></xs:attribute><xs:attribute name='IPMLanguage' type='xs:string'></xs:attribute><xs:attribute name='LicenseStart' type='xs:string'></xs:attribute><xs:attribute name='LicenseEnd' type='xs:string'></xs:attribute></xs:complexType></xs:element></xs:sequence></xs:complexType></xs:element></xs:sequence><xs:attribute name='ID' type='xs:string'></xs:attribute><xs:attribute name='Description' type='xs:string'></xs:attribute><xs:attribute name='ServicingStatus' type='xs:string'></xs:attribute><xs:attribute name='IPMStatus' type='xs:string'></xs:attribute><xs:attribute name='ContractualDueDate' type='xs:string'></xs:attribute><xs:attribute name='LicenseStartDate' type='xs:string'></xs:attribute><xs:attribute name='EOPResource' type='xs:string'></xs:attribute><xs:attribute name='PPSResource' type='xs:string'></xs:attribute></xs:complexType></xs:element></xs:sequence></xs:complexType></xs:element></xs:sequence><xs:attribute name='ID' type='xs:int'></xs:attribute><xs:attribute name='Description' type='xs:string'></xs:attribute><xs:attribute name='ServicingStatus' type='xs:string'></xs:attribute></xs:complexType></xs:element></xs:sequence></xs:complexType></xs:element></xs:sequence><xs:attribute name='ID' type='xs:string'></xs:attribute><xs:attribute name='Description' type='xs:string'></xs:attribute><xs:attribute name='TransactionType' type='xs:string'></xs:attribute><xs:attribute name='ServicingStatus' type='xs:string'></xs:attribute><xs:attribute name='RushOrder' type='xs:string'></xs:attribute><xs:attribute name='DueDate' type='xs:string'></xs:attribute><xs:attribute name='BusinessPartnerID' type='xs:string'></xs:attribute><xs:attribute name='BusinessPartner' type='xs:string'></xs:attribute><xs:attribute name='ProfileID' type='xs:string'></xs:attribute><xs:attribute name='ProfileDescription' type='xs:string'></xs:attribute><xs:attribute name='FastTrack' type='xs:string'></xs:attribute><xs:attribute name='CreatedDate' type='xs:string'></xs:attribute><xs:attribute name='CreatedBy' type='xs:string'></xs:attribute><xs:attribute name='CompletedDate' type='xs:string'></xs:attribute></xs:complexType></xs:element></xs:schema>";
            public static string XmlDoc = @"<?xml version='1.0' encoding='utf-8'?><ServiceRequest ID='SR00000874' Description='TURNER US - MARTY - Extended Version' TransactionType='Add' ServicingStatus='Completed'  RushOrder='Y' DueDate='07/01/2019' BusinessPartnerID='TURNER' BusinessPartner='Turner Entertainment Networks' ProfileID='PR00000568' ProfileDescription='Turner Broadcasting (ID# 2561) - United States - Deluxe' FastTrack='N'  CreatedDate='10/02/2019' CreatedBy='apereira' CompletedDate='10/07/2019'><Contracts><Contract ID='17'  Description='2019-2022 Turner Pool shell for 19-00040' ServicingStatus='Completed'><Titles><Title ID='MARTY' Description='MARTY'  ServicingStatus='Completed' IPMStatus='Finalized' ContractualDueDate='10/9/2019' LicenseStartDate='10/9/2019' EOPResource='BTHOMAS' PPSResource='BTHOMAS'><LineItems><LineItem ID='0000011750' ServicingStatus='Completed' IPMMedia='IS-PSOD-CU, IS-PSOD-SA, IS-PTV, TV-PSOD-CU, TV-PTV' IPMTerritory='AFGHAN, CHAD, DJIBOU, MAUITA, SOMALI, SSUDAN' IPMLanguage='ARA, FAS, INHIN, INURD' LicenseStart='08/01/2019' LicenseEnd='07/31/2020'><Orders><Order ID='1' ServicingStatus='Completed' Version='TheatricalVersion'><VendorId>Vubiquity</VendorId><SourceMioAssetId>TestSourceMioAssetId</SourceMioAssetId><ShellMioAssetId>TestShellMioAssetId</ShellMioAssetId><SRDueDate>07/01/2019</SRDueDate><EmbargoDate></EmbargoDate><PrimaryVideo>Y</PrimaryVideo><SecondaryAudio>French Parisian, Music And Effects</SecondaryAudio><SubtitlesFull>Arabic, English, French Parisian</SubtitlesFull><SubtitlesForced> French Parisian</SubtitlesForced><ClosedCaptions></ClosedCaptions><Trailer></Trailer><RebillType>Rebill A</RebillType><Amount></Amount><MetaData></MetaData><ArtWork></ArtWork><Document></Document><EOPPO></EOPPO><EOPDueDate></EOPDueDate><EOPStatus>Not Required</EOPStatus><EOPResource></EOPResource><EOPNotes></EOPNotes><PPSPO>4865863</PPSPO><PPSDueDate>07/01/2019</PPSDueDate><PPSStatus>Completed</PPSStatus><PPSResource></PPSResource><PPSNotes></PPSNotes><MaterialNotes>HD feature file naming conventions should follow the below template: BM-DF-MVXXXXXX.mxf HD trailer filenaming conventions should follow the below template: BR-DF-MVXXXXXX.mxf SD feature file naming conventions should follow the below template: FM-DF-MVXXXXXX.mxf SD trailer filenaming conventions should follow the below template: FR-DF-MVXXXXXX.mxf Here are the individual unique ID #s for each title:  ANNIE HALL MV012999 BLOW OUT MV013001 HOME OF OUR OWN, A MV013000 </MaterialNotes><Other></Other><IPMMedia></IPMMedia><Rejections><Rejection ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Rejection><Redelivered ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Redelivered><Resolved ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Resolved></Rejections></Order><Order ID='2' ServicingStatus='Completed' Version='TheatricalVersion'><VendorId>Vubiquity</VendorId><SourceMioAssetId>TestSourceMioAssetId</SourceMioAssetId><ShellMioAssetId>TestShellMioAssetId</ShellMioAssetId><SRDueDate>07/01/2019</SRDueDate><EmbargoDate></EmbargoDate><PrimaryVideo>Y</PrimaryVideo><SecondaryAudio>French Parisian, Music And Effects</SecondaryAudio><SubtitlesFull>Arabic, English, French Parisian</SubtitlesFull><SubtitlesForced> French Parisian</SubtitlesForced><ClosedCaptions></ClosedCaptions><Trailer></Trailer><RebillType>Rebill A</RebillType><Amount></Amount><MetaData></MetaData><ArtWork></ArtWork><Document></Document><EOPPO></EOPPO><EOPDueDate></EOPDueDate><EOPStatus>Not Required</EOPStatus><EOPResource></EOPResource><EOPNotes></EOPNotes><PPSPO>4865863</PPSPO><PPSDueDate>07/01/2019</PPSDueDate><PPSStatus>Completed</PPSStatus><PPSResource></PPSResource><PPSNotes></PPSNotes><MaterialNotes>HD feature file naming conventions should follow the below template: BM-DF-MVXXXXXX.mxf HD trailer filenaming conventions should follow the below template: BR-DF-MVXXXXXX.mxf SD feature file naming conventions should follow the below template: FM-DF-MVXXXXXX.mxf SD trailer filenaming conventions should follow the below template: FR-DF-MVXXXXXX.mxf Here are the individual unique ID #s for each title:  ANNIE HALL MV012999 BLOW OUT MV013001 HOME OF OUR OWN, A MV013000 </MaterialNotes><Other></Other><IPMMedia></IPMMedia><Rejections><Rejection ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Rejection><Redelivered ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Redelivered><Resolved ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Resolved></Rejections></Order></Orders></LineItem></LineItems></Title></Titles></Contract></Contracts></ServiceRequest>";

            public static string XmlDocPath = @"C:\Code\Mgm.VI\UnitTests\Mgm.VI.Business.UnitTests\TestData\SR00000874.xml";
            public static string XsdDocPath = @"C:\Code\Mgm.VI\UnitTests\Mgm.VI.Business.UnitTests\TestData\ServiceRequest_Schema.xsd";
            #endregion
        }
        static class MalformedData
        {
            public static string XmlDocEmpty = @"";
            public static string XmlDocIncorrectIds = @"<?xml version='1.0' encoding='utf-8' ?><ServiceRequest ID='SR00000874hh' Description='TURNER US - MARTY - Extended Version' TransactionType='Add' ServicingStatus='Completed'  RushOrder='Y' DueDate='07/01/2019' BusinessPartnerID='TURNER' BusinessPartner='Turner Entertainment Networks' ProfileID='PR00000568' ProfileDescription='Turner Broadcasting (ID# 2561) - United States - Deluxe' FastTrack='N'  CreatedDate='10/02/2019' CreatedBy='apereira' CompletedDate='10/07/2019'><Contracts><Contract ID='fasdfadsf17'  Description='2019-2022 Turner Pool shell for 19-00040' ServicingStatus='Completed'><Titles><Title ID='MARTY' Description='MARTY'  ServicingStatus='Completed' IPMStatus='Finalized' ContractualDueDate='10/9/2019' LicenseStartDate='10/9/2019' EOPResource='BTHOMAS' PPSResource='BTHOMAS'><LineItems><LineItem ID='0000011750' ServicingStatus='Completed' IPMMedia='IS-PSOD-CU, IS-PSOD-SA, IS-PTV, TV-PSOD-CU, TV-PTV' IPMTerritory='AFGHAN, CHAD, DJIBOU, MAUITA, SOMALI, SSUDAN' IPMLanguage='ARA, FAS, INHIN, INURD' LicenseStart='08/01/2019' LicenseEnd='07/31/2020'><Orders><Order ID='1adsfasdf' ServicingStatus='Completed' Version='TheatricalVersion'><VendorId>Vubiquity</VendorId><SourceMioAssetId>TestSourceMioAssetId</SourceMioAssetId><ShellMioAssetId>TestShellMioAssetId</ShellMioAssetId><SRDueDate>07/01/2019</SRDueDate><EmbargoDate></EmbargoDate><PrimaryVideo>Y</PrimaryVideo><SecondaryAudio>French Parisian, Music And Effects</SecondaryAudio><SubtitlesFull>Arabic, English, French Parisian</SubtitlesFull><SubtitlesForced> French Parisian</SubtitlesForced><ClosedCaptions></ClosedCaptions><Trailer></Trailer><RebillType>Rebill A</RebillType><Amount></Amount><MetaData></MetaData><ArtWork></ArtWork><Document></Document><EOPPO></EOPPO><EOPDueDate></EOPDueDate><EOPStatus>Not Required</EOPStatus><EOPResource></EOPResource><EOPNotes></EOPNotes><PPSPO>4865863</PPSPO><PPSDueDate>07/01/2019</PPSDueDate><PPSStatus>Completed</PPSStatus><PPSResource></PPSResource><PPSNotes></PPSNotes><MaterialNotes>HD feature file naming conventions should follow the below template: BM-DF-MVXXXXXX.mxf HD trailer filenaming conventions should follow the below template: BR-DF-MVXXXXXX.mxf SD feature file naming conventions should follow the below template: FM-DF-MVXXXXXX.mxf SD trailer filenaming conventions should follow the below template: FR-DF-MVXXXXXX.mxf Here are the individual unique ID #s for each title:  ANNIE HALL MV012999 BLOW OUT MV013001 HOME OF OUR OWN, A MV013000 </MaterialNotes><Other></Other><IPMMedia></IPMMedia><Rejections><Rejection ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Rejection><Redelivered ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Redelivered><Resolved ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Resolved></Rejections></Order><Order ID='2' ServicingStatus='Completed' Version='TheatricalVersion'><VendorId>Vubiquity</VendorId><SourceMioAssetId>TestSourceMioAssetId</SourceMioAssetId><ShellMioAssetId>TestShellMioAssetId</ShellMioAssetId><SRDueDate>07/01/2019</SRDueDate><EmbargoDate></EmbargoDate><PrimaryVideo>Y</PrimaryVideo><SecondaryAudio>French Parisian, Music And Effects</SecondaryAudio><SubtitlesFull>Arabic, English, French Parisian</SubtitlesFull><SubtitlesForced> French Parisian</SubtitlesForced><ClosedCaptions></ClosedCaptions><Trailer></Trailer><RebillType>Rebill A</RebillType><Amount></Amount><MetaData></MetaData><ArtWork></ArtWork><Document></Document><EOPPO></EOPPO><EOPDueDate></EOPDueDate><EOPStatus>Not Required</EOPStatus><EOPResource></EOPResource><EOPNotes></EOPNotes><PPSPO>4865863</PPSPO><PPSDueDate>07/01/2019</PPSDueDate><PPSStatus>Completed</PPSStatus><PPSResource></PPSResource><PPSNotes></PPSNotes><MaterialNotes>HD feature file naming conventions should follow the below template: BM-DF-MVXXXXXX.mxf HD trailer filenaming conventions should follow the below template: BR-DF-MVXXXXXX.mxf SD feature file naming conventions should follow the below template: FM-DF-MVXXXXXX.mxf SD trailer filenaming conventions should follow the below template: FR-DF-MVXXXXXX.mxf Here are the individual unique ID #s for each title:  ANNIE HALL MV012999 BLOW OUT MV013001 HOME OF OUR OWN, A MV013000 </MaterialNotes><Other></Other><IPMMedia></IPMMedia><Rejections><Rejection ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Rejection><Redelivered ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Redelivered><Resolved ID='' CurrentStatus='' Asset='' RejectionCode='' Issue='' CommentsHistory=''  RejectedBy='' RejectionDate='' Urgency='' RootCause='' Document=''></Resolved></Rejections></Order></Orders></LineItem></LineItems></Title></Titles></Contract></Contracts></ServiceRequest>";
            public static string XmlDocMalformedXml = @"<?xml version='1.0' encoding='utf-8' ?><ServiceRequest ID='74' Description='TURNER US - MARTY - Extended Version' TransactionType='Add' ServicingStatus='Completed'  RushOrder='Y' DueDate='07/01/2019' BusinessPartnerID='TURNER' BusinessPartner='Turner Entertainment Networks' ProfileID='PR00000568' ProfileDescription='Turner Broadcasting (ID# 2561) - United States - Deluxe' FastTrack='N'  CreatedDate='10/02/2019' CreatedBy='apereira' CompletedDate='10/07/2019'><Contracts><Contract ID='17'  Description='2019-2022 Turner Pool shell for 19-00040' ServicingStatus='Completed'><Titles><Title ID='MARTY' Description='MARTY'  ServicingStatus='Completed' IPMStatus='Finalized' ContractualDueDate='10/9/2019' LicenseStartDate='10/9/2019' EOPResource='BTHOMAS' PPSResource='BTHOMAS'><LineItems><LineItem ID='0000011750' ServicingStatus='Completed' IPMMedia='IS-PSOD-CU, IS-PSOD-SA, IS-PTV, TV-PSOD-CU, TV-PTV' IPMTerritory='AFGHAN, CHAD, DJIBOU, MAUITA, SOMALI, SSUDAN' IPMLanguage='ARA, FAS, INHIN, INURD' LicenseStart='08/01/2019' LicenseEnd='07/31/2020'><Orders><Order ID='1' ServicingStatus='Completed' Version='TheatricalVersion'><VendorId>Vubiquity</VendorId><SourceMioAssetId>TestSourceMioAssetId</SourceMioAssetId><ShellMioAssetId>TestShellMioAssetId</ShellMioAssetId><SRDueDate>07/01/2019</SRDueDate><EmbargoDate></EmbargoDate><PrimaryVideo>Y</PrimaryVideo><SecondaryAudio>French Parisian, Music And Effects</SecondaryAudio></Title></Titles></Contract></Contracts></ServiceRequest>";
            public static string XmlDocMissingAccounts = @"<?xml version='1.0' encoding='utf-8' ?><ServiceRequest ID='74' Description='TURNER US - MARTY - Extended Version' TransactionType='Add' ServicingStatus='Completed'  RushOrder='Y' DueDate='07/01/2019' BusinessPartnerID='TURNER' BusinessPartner='Turner Entertainment Networks' ProfileID='PR00000568' ProfileDescription='Turner Broadcasting (ID# 2561) - United States - Deluxe' FastTrack='N'  CreatedDate='10/02/2019' CreatedBy='apereira' CompletedDate='10/07/2019'></ServiceRequest>";
            public static string XmlDocMissingOrders = @"<?xml version='1.0' encoding='utf-8' ?><ServiceRequest ID='SR00000874' Description='TURNER US - MARTY - Extended Version' TransactionType='Add' ServicingStatus='Completed'  RushOrder='Y' DueDate='07/01/2019' BusinessPartnerID='TURNER' BusinessPartner='Turner Entertainment Networks' ProfileID='PR00000568' ProfileDescription='Turner Broadcasting (ID# 2561) - United States - Deluxe' FastTrack='N'  CreatedDate='10/02/2019' CreatedBy='apereira' CompletedDate='10/07/2019'><Contracts><Contract ID='17'  Description='2019-2022 Turner Pool shell for 19-00040' ServicingStatus='Completed'><Titles><Title ID='MARTY' Description='MARTY'  ServicingStatus='Completed' IPMStatus='Finalized' ContractualDueDate='10/9/2019' LicenseStartDate='10/9/2019' EOPResource='BTHOMAS' PPSResource='BTHOMAS'><LineItems><LineItem ID='0000011750' ServicingStatus='Completed' IPMMedia='IS-PSOD-CU, IS-PSOD-SA, IS-PTV, TV-PSOD-CU, TV-PTV' IPMTerritory='AFGHAN, CHAD, DJIBOU, MAUITA, SOMALI, SSUDAN' IPMLanguage='ARA, FAS, INHIN, INURD' LicenseStart='08/01/2019' LicenseEnd='07/31/2020'></LineItem></LineItems></Title></Titles></Contract></Contracts></ServiceRequest>";
            public static string XmlDocPathFail = @"C:\Code\Mgm.VI\UnitTests\Mgm.VI.Common.UnitTests\TestData\SR00000874FAIL.xml";

            public static string XsdDocEmpty = @"";
            public static string XsdDocPathFail = @"C:\Code\Mgm.VI\UnitTests\Mgm.VI.Common.UnitTests\TestData\ServiceRequest_SchemaFAIL.xsd";
        }
        #region Instantiate Class
        [Fact]
        public void Success_Test_Instantiate_Valid_Content()
        {
            XmlProcessor result = XmlProcessor.New(ValidData.XmlDoc, false);
            Assert.True(result != null, " Xml Validation: Instantiate(...) From Content Successful Test Passed.");
        }
        [Fact]
        public void Success_Test_Instantiate_Valid_FilePath_Content()
        {
            XmlProcessor result = XmlProcessor.New(ValidData.XmlDocPath, true);
            Assert.True(result != null, " Xml Validation: Instantiate(...) From FilePath Successful Test Passed.");
        }
        [Fact]
        public void Failure_Test_Instantiate_Invalid_FilePath_Content()
        {
            XmlProcessor result = XmlProcessor.New(MalformedData.XmlDocPathFail, true);
            Assert.True(result == null, " Xml Validation: Instantiate(...) Invalid FilePath Test Passed.");
        }
        [Fact]
        public void Failure_Test_Instantiate_Invalid_FilePath_Content_With_Exception()
        {
            var result = Assert.Throws<Exception>(() => XmlProcessor.New(MalformedData.XmlDocPathFail, true, false, false));
            Assert.NotNull(result);
        }
        [Fact]
        public void Failure_Test_Instantiate_Malformed_File_Xml_Content()
        {
            XmlProcessor result = XmlProcessor.New(MalformedData.XmlDocMalformedXml);
            Assert.True(result == null, " Xml Validation: Instantiate(...) Malformed File Content Test Passed.");
        }
        #endregion Instantiate Class

        #region ParseXml()
        [Fact]
        public void Success_Test_ParseXml_Valid_Xml()
        {
            var result = ServiceRequestDto.Parse(ValidData.XmlDoc, ValidData.XsdDocPath);
            Assert.NotNull(result);
        }
        [Fact]
        public void Success_Test_ParseXml_Valid_Xml_Count_Not_Zero()
        {
            var result = ServiceRequestDto.Parse(ValidData.XmlDoc, ValidData.XsdDocPath);
            Assert.True(result.Count > 0, "ParseXml(...).Count > 0: Successful Test Passed.");
        }
        [Fact]
        public void Failure_Test_ParseXml_Returns_Null()
        {
            XDocument xmldoc = null;
            var result = ServiceRequestDto.Parse(xmldoc, ValidData.XsdDocPath, ServiceRequestDto.XmlFieldName, false);
            Assert.Null(result);
        }
        [Fact]
        public void Failure_Test_ParseXDoc_InvalidXsdDocPath()
        {
            XDocument xmldoc = XmlProcessor.LoadContent(ValidData.XmlDoc);
            var result = ServiceRequestDto.Parse(xmldoc, MalformedData.XsdDocPathFail, ServiceRequestDto.XmlFieldName);
            Assert.Null(result);
        }
        [Fact]
        public void Failure_Test_IsXml_Malformed_Xml()
        {
            var result = ServiceRequestDto.Parse(MalformedData.XmlDocMalformedXml, ValidData.XsdDocPath);
            Assert.Null(result);
        }
        #endregion ParseXml()
    }
}
